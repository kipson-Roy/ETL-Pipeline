{"cells":[{"cell_type":"code","source":["aws_keys_df = spark.read.format(\"csv\").option(\"header\",\"true\").option(\"inferSchema\",\"true\").load(\"/FileStore/tables/Kipson_Roy_ETL_accessKeys.csv\")"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"c27789b1-c038-4f90-931e-770254791d5e","inputWidgets":{},"title":""}},"outputs":[],"execution_count":0},{"cell_type":"code","source":["ACCESS_KEY = aws_keys_df.select('Access key ID').take(1)[0]['Access key ID']\nSECRET_KEY = aws_keys_df.select('Secret access key').take(1)[0]['Secret access key']"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"6b96dff9-2a5c-419f-bbc9-bde9379a7e1d","inputWidgets":{},"title":""}},"outputs":[],"execution_count":0},{"cell_type":"code","source":["import urllib\n\nENCODED_SECRET_KEY = urllib.parse.quote(string=SECRET_KEY,safe=\"\")"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"b7553fe4-63c6-4722-a6e8-17b82c9c7243","inputWidgets":{},"title":""}},"outputs":[],"execution_count":0},{"cell_type":"code","source":["AWS_S3_BUCKET = 'kipson-roy-etl-project'\nMOUNT_NAME = '/mnt/kipson-roy-etl-project/'\n\nSOURCE_URL = \"s3a://%s:%s@%s\" %(ACCESS_KEY,ENCODED_SECRET_KEY,AWS_S3_BUCKET)"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"959f719d-8563-4e74-a479-ea33a677e549","inputWidgets":{},"title":""}},"outputs":[],"execution_count":0},{"cell_type":"code","source":["dbutils.fs.mount(SOURCE_URL,MOUNT_NAME)"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"220a43da-bd16-4f4a-8909-026fd0c4e112","inputWidgets":{},"title":""}},"outputs":[{"output_type":"stream","output_type":"stream","name":"stdout","text":["Out[7]: True"]}],"execution_count":0},{"cell_type":"code","source":["%fs ls '/mnt/kipson-roy-etl-project/'"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"284025df-daea-47b4-8c0f-8e5d158064e4","inputWidgets":{},"title":""}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n","  .table-result-container {\n","    max-height: 300px;\n","    overflow: auto;\n","  }\n","  table, th, td {\n","    border: 1px solid black;\n","    border-collapse: collapse;\n","  }\n","  th, td {\n","    padding: 5px;\n","  }\n","  th {\n","    text-align: left;\n","  }\n","</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr></tr></thead><tbody></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["dbutils.fs.unmount(MOUNT_NAME)"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"078f4c4b-ff45-4c52-986d-ca14913ba6c4","inputWidgets":{},"title":""}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"data":"\u001B[0;31m---------------------------------------------------------------------------\u001B[0m\n\u001B[0;31mNameError\u001B[0m                                 Traceback (most recent call last)\n\u001B[0;32m<command-871282566951778>\u001B[0m in \u001B[0;36m<cell line: 1>\u001B[0;34m()\u001B[0m\n\u001B[0;32m----> 1\u001B[0;31m \u001B[0mdbutils\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mfs\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0munmount\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mMOUNT_NAME\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\n\u001B[0m\n\u001B[0;31mNameError\u001B[0m: name 'MOUNT_NAME' is not defined","errorSummary":"<span class='ansi-red-fg'>NameError</span>: name 'MOUNT_NAME' is not defined","metadata":{},"errorTraceType":"ansi","type":"ipynbError","arguments":{}}},"output_type":"display_data","data":{"text/plain":["\u001B[0;31m---------------------------------------------------------------------------\u001B[0m\n","\u001B[0;31mNameError\u001B[0m                                 Traceback (most recent call last)\n","\u001B[0;32m<command-871282566951778>\u001B[0m in \u001B[0;36m<cell line: 1>\u001B[0;34m()\u001B[0m\n","\u001B[0;32m----> 1\u001B[0;31m \u001B[0mdbutils\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mfs\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0munmount\u001B[0m\u001B[0;34m(\u001B[0m\u001B[0mMOUNT_NAME\u001B[0m\u001B[0;34m)\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\n","\u001B[0m\n","\u001B[0;31mNameError\u001B[0m: name 'MOUNT_NAME' is not defined"]}}],"execution_count":0}],"metadata":{"application/vnd.databricks.v1+notebook":{"notebookName":"Mount s3","dashboards":[],"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":871282566951777,"dataframes":["_sqldf"]}},"language":"python","widgets":{},"notebookOrigID":871282566951770}},"nbformat":4,"nbformat_minor":0}
